var _0x8737=['forEach','addPolyGon','RIGHT_CLICK','none','Color','log','Plane','Cartesian3','#clearExcavation','cullDept','push','lerp','multiplyByScalar','fromDegrees','Cartographic','viewer','addClass','#startExcavation','judgeClockWise','normalize','fromCartesian','add','excavationHandler','.pannel-btn-active','withAlpha','ClippingPlane','name','getPointDistance','clearExcavation','all','calHeight','wall','camera','ClippingPlaneCollection','viewModel','ScreenSpaceEventHandler','subtract','entities','terrainProvider','LEFT_CLICK','longitude','#excavationInput','length','tileset','CLAMP_TO_GROUND','pannel-btn-active','HeightReference','setInputAction','assign','display','getPickRay','when','startExcavation','getLngLat','height','click','excavationPannel','polyline','多边形需要绘制凸多边形','css','scene','GREEN','positions','Cartesian2','points','ScreenSpaceEventType','convex','show','polygon','reverse','./Images/di.jpg','latitude','alert','addPoint','clippingPlanes','CallbackProperty','#closeExcavationPannel','canvas','toDegrees','bottom','ImageMaterialProperty','then','pick','globe','Math','cull','val','trim','RED','多边形至少需要3个点','PolygonHierarchy','remove'];(function(_0x1d180d,_0x42da2f){var _0x873753=function(_0x41d9b3){while(--_0x41d9b3){_0x1d180d['push'](_0x1d180d['shift']());}};_0x873753(++_0x42da2f);}(_0x8737,0x1ba));var _0x41d9=function(_0x1d180d,_0x42da2f){_0x1d180d=_0x1d180d-0x177;var _0x873753=_0x8737[_0x1d180d];return _0x873753;};'use strict';oExcavation={'viewModel':{'cullDept':0x32},'positions':[],'points':[],'polyline':null,'polygon':null,'excavationHandler':null,'clippingPlanes':[],'wall':null,'bottom':null,'closePannel':function(){var _0x377f79=_0x41d9;$(_0x377f79(0x1c1))[_0x377f79(0x1c4)](_0x377f79(0x1ba),'none');},'startExcavation':function(){var _0x1624be=_0x41d9;$(_0x1624be(0x19a))['is'](_0x1624be(0x1a0))?($(_0x1624be(0x19a))['removeClass'](_0x1624be(0x1b6)),oExcavation['clearExcavation'](),oDefault['tilesetList'][_0x1624be(0x189)](function(_0x548351){var _0x1bca63=_0x1624be;'地面'==_0x548351[_0x1bca63(0x1a3)]&&(_0x548351[_0x1bca63(0x1b4)][_0x1bca63(0x1cc)]=!0x0);})):($(_0x1624be(0x19a))[_0x1624be(0x199)](_0x1624be(0x1b6)),oDefault['tilesetList'][_0x1624be(0x189)](function(_0x258f5b){var _0x2fb39b=_0x1624be;'地面'==_0x258f5b[_0x2fb39b(0x1a3)]&&(_0x258f5b[_0x2fb39b(0x1b4)][_0x2fb39b(0x1cc)]=!0x1);}));},'getLngLat':function(_0x3c5091){var _0x531b8c=_0x41d9,_0x2b284c=oDefault['viewer'],_0x3c5091=_0x2b284c[_0x531b8c(0x1c5)][_0x531b8c(0x180)][_0x531b8c(0x17f)](_0x2b284c[_0x531b8c(0x1a9)][_0x531b8c(0x1bb)](_0x3c5091),_0x2b284c['scene']),_0x2b284c=Cesium['Cartographic'][_0x531b8c(0x19d)](_0x3c5091),_0x3c5091=Cesium['Math'][_0x531b8c(0x17b)](_0x2b284c[_0x531b8c(0x1d0)]),_0x2b284c=Cesium['Math'][_0x531b8c(0x17b)](_0x2b284c['longitude']);return Cesium['Cartesian3'][_0x531b8c(0x196)](_0x2b284c,_0x3c5091);},'addPoint':function(_0x4292a7){var _0x187f53=_0x41d9;_0x4292a7=oDefault[_0x187f53(0x198)]['entities'][_0x187f53(0x19e)]({'position':_0x4292a7,'point':{'color':Cesium[_0x187f53(0x18d)][_0x187f53(0x1c6)],'pixelSize':0xa,'heightReference':Cesium[_0x187f53(0x1b7)][_0x187f53(0x1b5)]}}),oExcavation[_0x187f53(0x1c9)][_0x187f53(0x193)](_0x4292a7);},'addLine':function(_0x309bbd){var _0x3fc90e=_0x41d9,_0x497b62=oDefault['viewer'],_0x332272=new Cesium['CallbackProperty'](function(){return _0x309bbd;},!0x1);oExcavation[_0x3fc90e(0x1c2)]=_0x497b62[_0x3fc90e(0x1ae)][_0x3fc90e(0x19e)]({'polyline':{'positions':_0x332272,'width':0x4,'material':Cesium['Color']['RED'],'depthFailMaterial':Cesium[_0x3fc90e(0x18d)][_0x3fc90e(0x185)],'height':0x32}});},'addPolyGon':function(_0x5c38b0){var _0x392fde=_0x41d9,_0x4374bb=oDefault[_0x392fde(0x198)],_0x16632b=new Cesium['CallbackProperty'](function(){var _0x433cc2=_0x392fde;return new Cesium[(_0x433cc2(0x187))](_0x5c38b0);},!0x1);oExcavation[_0x392fde(0x1cd)]=_0x4374bb[_0x392fde(0x1ae)][_0x392fde(0x19e)]({'polygon':{'hierarchy':_0x16632b,'material':Cesium[_0x392fde(0x18d)][_0x392fde(0x185)][_0x392fde(0x1a1)](0.4),'height':11.5}});},'calHeight':function(_0x19de6a,_0x170877,_0x56f9d3){var _0x3faf67=_0x41d9;for(var _0x55c3a7=oDefault[_0x3faf67(0x198)],_0x306c5e=[],_0x1258be=0x0;_0x1258be<=_0x56f9d3;_0x1258be++){var _0x4a0dd2=Cesium[_0x3faf67(0x190)][_0x3faf67(0x194)](_0x19de6a,_0x170877,_0x1258be/_0x56f9d3,new Cesium[(_0x3faf67(0x190))]());_0x306c5e[_0x3faf67(0x193)](Cesium[_0x3faf67(0x197)]['fromCartesian'](_0x4a0dd2));}return new Promise(function(_0x599dd7,_0x39274c){var _0x3b034e=_0x3faf67,_0x38f1b7=Cesium['sampleTerrainMostDetailed'](_0x55c3a7[_0x3b034e(0x1af)],_0x306c5e);Cesium[_0x3b034e(0x1bc)](_0x38f1b7,function(_0x4c6fe1){_0x599dd7(_0x4c6fe1);});});},'cull':function(_0x1afca7){var _0x6d1299=_0x41d9;''!=$(_0x6d1299(0x1b2))[_0x6d1299(0x183)]()[_0x6d1299(0x184)]()&&(oExcavation[_0x6d1299(0x1ab)]['cullDept']=$(_0x6d1299(0x1b2))['val']()[_0x6d1299(0x184)]());var _0x2fd9b0=oDefault[_0x6d1299(0x198)];if(_0x1afca7[_0x6d1299(0x1b3)]<0x3)return window[_0x6d1299(0x1d1)](_0x6d1299(0x186)),!0x1;console[_0x6d1299(0x18e)](_0x1afca7);var _0x5efb0e=[];if(Object['assign'](_0x5efb0e,_0x1afca7),oExcavation[_0x6d1299(0x19b)](_0x5efb0e)&&(_0x5efb0e=_0x5efb0e[_0x6d1299(0x1ce)]()),0x1!=oExcavation[_0x6d1299(0x1cb)](_0x5efb0e,_0x5efb0e['length']))return window[_0x6d1299(0x1d1)](_0x6d1299(0x1c3)),oExcavation[_0x6d1299(0x1a5)](),!0x1;var _0x4db738=_0x5efb0e[_0x6d1299(0x1b3)];oExcavation[_0x6d1299(0x177)]=[];for(var _0x586745=0x0;_0x586745<_0x4db738;++_0x586745){var _0x2430f8=(_0x586745+0x1)%_0x4db738,_0x3e24db=Cesium['Cartesian3'][_0x6d1299(0x19e)](_0x5efb0e[_0x586745],_0x5efb0e[_0x2430f8],new Cesium[(_0x6d1299(0x190))]()),_0x3e24db=Cesium[_0x6d1299(0x190)][_0x6d1299(0x195)](_0x3e24db,0.5,_0x3e24db),_0x58733b=Cesium[_0x6d1299(0x190)][_0x6d1299(0x19c)](_0x3e24db,new Cesium[(_0x6d1299(0x190))]()),_0x2430f8=Cesium['Cartesian3'][_0x6d1299(0x1ad)](_0x5efb0e[_0x2430f8],_0x3e24db,new Cesium[(_0x6d1299(0x190))]()),_0x2430f8=Cesium[_0x6d1299(0x190)][_0x6d1299(0x19c)](_0x2430f8,_0x2430f8),_0x2430f8=Cesium['Cartesian3']['cross'](_0x2430f8,_0x58733b,new Cesium[(_0x6d1299(0x190))]()),_0x2430f8=Cesium[_0x6d1299(0x190)][_0x6d1299(0x19c)](_0x2430f8,_0x2430f8),_0x58733b=new Cesium[(_0x6d1299(0x18f))](_0x2430f8,0x0),_0x3e24db=Cesium['Plane'][_0x6d1299(0x1a4)](_0x58733b,_0x3e24db);oExcavation[_0x6d1299(0x177)][_0x6d1299(0x193)](new Cesium[(_0x6d1299(0x1a2))](_0x2430f8,_0x3e24db));}_0x2fd9b0[_0x6d1299(0x1c5)][_0x6d1299(0x180)][_0x6d1299(0x177)]=new Cesium[(_0x6d1299(0x1aa))]({'planes':oExcavation['clippingPlanes'],'edgeWidth':0x1,'edgeColor':Cesium[_0x6d1299(0x18d)]['WHITE']}),_0x5efb0e[_0x6d1299(0x193)](_0x5efb0e[0x0]);for(var _0x259dfd=[],_0x586745=0x0;_0x586745<_0x5efb0e[_0x6d1299(0x1b3)]-0x1;_0x586745++){var _0x5c6604=oExcavation[_0x6d1299(0x1a7)](_0x5efb0e[_0x586745],_0x5efb0e[_0x586745+0x1],0xc8);_0x259dfd[_0x6d1299(0x193)](_0x5c6604);}Promise[_0x6d1299(0x1a6)](_0x259dfd)[_0x6d1299(0x17e)](function(_0x5d1171){var _0x43b1c2=_0x6d1299,_0x5d1171=_0x5d1171['flat'](0x1/0x0),_0x4cf229=[],_0x2666fb=[];_0x5d1171['forEach'](function(_0x527824){var _0x5d46db=_0x41d9;_0x4cf229[_0x5d46db(0x193)](_0x527824[_0x5d46db(0x1bf)]),_0x2666fb[_0x5d46db(0x193)](Cesium[_0x5d46db(0x190)][_0x5d46db(0x196)](Cesium[_0x5d46db(0x181)][_0x5d46db(0x17b)](_0x527824[_0x5d46db(0x1b1)]),Cesium[_0x5d46db(0x181)][_0x5d46db(0x17b)](_0x527824['latitude'])));}),oExcavation[_0x43b1c2(0x1a8)]=_0x2fd9b0['entities'][_0x43b1c2(0x19e)]({'wall':{'positions':_0x2666fb,'material':new Cesium[(_0x43b1c2(0x17d))]({'image':'./Images/ce.jpg','repeat':new Cesium['Cartesian2'](_0x2666fb[_0x43b1c2(0x1b3)],0x1)}),'maximumHeights':_0x4cf229,'minimumHeights':new Cesium[(_0x43b1c2(0x178))](function(){var _0x20015a=_0x43b1c2;for(var _0x16cd65=[],_0x1ec2b6=0x0;_0x1ec2b6<_0x2666fb['length'];_0x1ec2b6++)_0x16cd65[_0x20015a(0x193)](-oExcavation[_0x20015a(0x1ab)][_0x20015a(0x192)]);return _0x16cd65;},!0x1)}}),oExcavation[_0x43b1c2(0x17c)]=_0x2fd9b0[_0x43b1c2(0x1ae)][_0x43b1c2(0x19e)]({'polygon':{'hierarchy':new Cesium[(_0x43b1c2(0x187))](_0x5efb0e),'material':new Cesium['ImageMaterialProperty']({'image':_0x43b1c2(0x1cf),'repeat':new Cesium[(_0x43b1c2(0x1c8))](_0x5efb0e[_0x43b1c2(0x1b3)]/0x2,_0x5efb0e['length']/0x2)}),'closeTop':!0x1,'height':new Cesium[(_0x43b1c2(0x178))](function(){var _0x411491=_0x43b1c2;return-oExcavation[_0x411491(0x1ab)][_0x411491(0x192)];},!0x1)}});});},'judgeClockWise':function(){var _0x20450a=_0x41d9,_0xce110e=[];Object[_0x20450a(0x1b9)](_0xce110e,oExcavation[_0x20450a(0x1c7)]),_0xce110e['push'](_0xce110e[0x0]);for(var _0x34f7bf=0x0,_0x1f5f22=0x0;_0x1f5f22<_0xce110e[_0x20450a(0x1b3)]-0x1;_0x1f5f22++)_0x34f7bf+=_0xce110e[_0x1f5f22]['x']*_0xce110e[_0x1f5f22+0x1]['y']-_0xce110e[_0x1f5f22+0x1]['x']*_0xce110e[_0x1f5f22]['y'];return _0x34f7bf<0x0;},'convex':function(_0x1209a1,_0x203fe5){var _0x7b42e9,_0x564a93,_0x30faae,_0xbe3a9b=0x0;if(_0x203fe5<0x3)return 0x0;for(var _0x4a4829=0x0;_0x4a4829<_0x203fe5;_0x4a4829++)if(_0x564a93=(_0x4a4829+0x2)%_0x203fe5,_0x30faae=(_0x1209a1[_0x7b42e9=(_0x4a4829+0x1)%_0x203fe5]['x']-_0x1209a1[_0x4a4829]['x'])*(_0x1209a1[_0x564a93]['y']-_0x1209a1[_0x7b42e9]['y']),(_0x30faae-=(_0x1209a1[_0x7b42e9]['y']-_0x1209a1[_0x4a4829]['y'])*(_0x1209a1[_0x564a93]['x']-_0x1209a1[_0x7b42e9]['x']))<0x0?_0xbe3a9b|=0x1:0x0<_0x30faae&&(_0xbe3a9b|=0x2),0x3==_0xbe3a9b)return-0x1;return 0x0!=_0xbe3a9b?0x1:0x0;},'clearExcavation':function(){var _0xf28d6f=_0x41d9,_0x5a8bef=oDefault['viewer'];console[_0xf28d6f(0x18e)](_0x5a8bef[_0xf28d6f(0x1c5)][_0xf28d6f(0x180)][_0xf28d6f(0x177)]['planes']),_0x5a8bef[_0xf28d6f(0x1c5)]['globe'][_0xf28d6f(0x177)]=void 0x0,oDefault[_0xf28d6f(0x198)]['entities']['remove'](oExcavation[_0xf28d6f(0x1a8)]),oDefault['viewer'][_0xf28d6f(0x1ae)][_0xf28d6f(0x188)](oExcavation[_0xf28d6f(0x17c)]),oExcavation[_0xf28d6f(0x1a8)]=null,oExcavation['bottom']=null,oExcavation[_0xf28d6f(0x1cd)]=null,oExcavation[_0xf28d6f(0x1c9)][_0xf28d6f(0x189)](function(_0x2ea362){var _0x26a359=_0xf28d6f;oDefault['viewer'][_0x26a359(0x1ae)][_0x26a359(0x188)](_0x2ea362);}),oExcavation[_0xf28d6f(0x1c9)]=[],oExcavation[_0xf28d6f(0x1c7)]=[];},'onBindAllBtnClick':function(){var _0x29988d=_0x41d9;$(_0x29988d(0x179))['on']('click',function(){var _0x41d5ab=_0x29988d;$('#excavationPannel')['css'](_0x41d5ab(0x1ba),_0x41d5ab(0x18c));}),$(_0x29988d(0x19a))['on'](_0x29988d(0x1c0),function(){var _0x196f73=_0x29988d;oExcavation[_0x196f73(0x1bd)]();}),$(_0x29988d(0x191))['on']('click',function(){oExcavation['clearExcavation']();});}},$(function(_0x167d54){var _0x35f095=_0x41d9;oExcavation['onBindAllBtnClick'](),oExcavation[_0x35f095(0x19f)]=new Cesium[(_0x35f095(0x1ac))](oDefault[_0x35f095(0x198)][_0x35f095(0x1c5)][_0x35f095(0x17a)]),oExcavation[_0x35f095(0x19f)][_0x35f095(0x1b8)](function(_0x25638a){var _0x19b66d=_0x35f095;_0x167d54(_0x19b66d(0x19a))['is'](_0x19b66d(0x1a0))&&(_0x25638a=oExcavation[_0x19b66d(0x1be)](_0x25638a['position']),oExcavation[_0x19b66d(0x1c7)][_0x19b66d(0x193)](_0x25638a),oExcavation[_0x19b66d(0x1d2)](_0x25638a),0x2==oExcavation[_0x19b66d(0x1c7)][_0x19b66d(0x1b3)]?oExcavation['addLine'](oExcavation['positions']):0x3==oExcavation[_0x19b66d(0x1c7)][_0x19b66d(0x1b3)]&&(oDefault[_0x19b66d(0x198)][_0x19b66d(0x1ae)][_0x19b66d(0x188)](oExcavation['polyline']),oExcavation[_0x19b66d(0x18a)](oExcavation[_0x19b66d(0x1c7)])));},Cesium[_0x35f095(0x1ca)][_0x35f095(0x1b0)]),oExcavation[_0x35f095(0x19f)][_0x35f095(0x1b8)](function(){var _0x536849=_0x35f095;_0x167d54('#startExcavation')['is']('.pannel-btn-active')&&(oExcavation[_0x536849(0x182)](oExcavation[_0x536849(0x1c7)]),oDefault[_0x536849(0x198)][_0x536849(0x1ae)][_0x536849(0x188)](oExcavation[_0x536849(0x1cd)]));},Cesium[_0x35f095(0x1ca)][_0x35f095(0x18b)]);});